<ts-page-scaffold pageAvailability="ready">
  <article #articleRef class="schema-page" style="display: flex; flex-direction: row;">
    <ts-schema-tool-window resizable [percent]="20" [title]="'Schema Explorer'"/>
    <div class="visualiser-pane card" resizable [percent]="80">
      <div class="card-header">
        <h5>Visualiser</h5>
        <div class="flex-spacer"></div>
        <button mat-stroked-button [disabled]="!(state.interactable$ | async)"
                [matTooltip]="(state.interactionDisabledReason$ | async) || ''" matTooltipPosition="below" (click)="state.refresh()">
          <i class="fa-light fa-refresh"></i>
          <span>Refresh</span>
        </button>
      </div>
      @if ((driver.status$ | async) === "disconnected") {
        <div class="answers-placeholder-container">
          <button mat-flat-button routerLink="/connect">
            <i class="fa-light fa-bolt"></i><span>Connect TypeDB server</span>
          </button>
        </div>
      } @else if (!(driver.database$ | async)) {
        <div class="answers-placeholder-container">
          <button mat-flat-button (click)="openSelectDatabaseDialog()">
            <i class="fa-light fa-database"></i><span>Select database</span>
          </button>
        </div>
      } @else {
        <div class="answers-outer-container">
          <div class="answers-container answers-structure-container">
            <div id="structureView" #graphViewRef></div>

            @switch (state.visualiser.status) {
              @case ("error") {
                <p class="status-text">The schema tool encountered an error.</p>
              }
              @case ("running") {
                <p class="status-text">Loading...</p>
              }
              @case ("noAnswers") {
                <p class="status-text">This is an empty database with no schema defined yet. <a routerLink="/query">Go to query tool</a> / <a href="https://typedb.com/docs/home/get-started/schema" target="_blank">learn about schemas</a></p>
              }
            }
          </div>
        </div>
      }
    </div>
  </article>
</ts-page-scaffold>
