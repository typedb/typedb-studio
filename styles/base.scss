/*!/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */

@use "sass:color";

@use "colors";
@use "media";
@use "mixins";
@use "shapes";
@use "typography";
@use "topbar";

@forward "fonts";
@forward "material";
@forward "material-overrides";
@forward "prism";
@forward "scrollbars";
@forward "vars";

html {
    height: 100%;
    margin: 0;
    padding: 0;
    background: colors.$black;
    font-size: 14px;
    line-height: 22px;

    --mat-form-field-subscript-text-size: 14px;
    letter-spacing: var(--body-letter-spacing);
}

body {
    margin: 0;
    padding: 0;
    font-family: typography.$default-font-family;
    overflow-x: hidden;

    --font-size-code: 14px;
    --line-height-code: 22px;
}

html, body {
    color-scheme: dark;
    height: 100%;
}

* {
    box-sizing: border-box;
}

article {
    section + section {
        margin-top: 32px;
        padding-top: 32px;
        border-top: shapes.$border;
    }
}

.tp-bento-container {
    display: flex;

    &.row {
        flex-direction: row;
        width: 100%;
    }

    &.col {
        flex-direction: column;
    }
}

.tp-bento-box {
    @include shapes.standard-border;
    border-radius: shapes.$border-radius;
    @include colors.light-source-gradient(colors.$purple, colors.$deep-purple);
    transition: background 0.1s linear;
    padding: shapes.$card-padding;

    display: flex;
    flex-direction: column;
    gap: 12px;

    $subtle-opacity: 0.45;
    &.subtle {
        @include colors.light-source-gradient(
                rgba(colors.$purple, $subtle-opacity),
                rgba(colors.$deep-purple, $subtle-opacity),
        );
        border-color: rgba(colors.$light-purple, $subtle-opacity);
    }

    &.hoverable:hover:not(:disabled) {
        @include colors.light-source-gradient(rgba(colors.$light-purple, 0.6), colors.$purple);

        &.subtle {
            @include colors.light-source-gradient(
                    rgba(rgba(colors.$light-purple, 0.6), $subtle-opacity),
                    rgba(colors.$purple, $subtle-opacity)
            );
        }
    }

    &.with-bottom-bar {
        padding-bottom: 0;
    }

    .tp-bento-bottom-bar {
        width: calc(100% + 2 * shapes.$card-padding);
        text-align: right;
        border-top: shapes.$border;
        border-color: inherit;
        padding-top: 12px;
        padding-bottom: 12px;
        padding-right: shapes.$card-padding;
        position: relative;
        right: calc(-1 * shapes.$card-padding);
        margin-top: 12px;
        align-self: flex-end;
        transition: background 100ms;
    }

    a.tp-bento-bottom-bar:hover {
        color: colors.$green;
        background: colors.$purple;
    }
}

h1, h2, h3, h4, h5, h6, p, ul, ol, dl, dt, dd, pre, figure {
    margin: 0;
    padding: 0;
}

h1 {
    @include typography.h1;
}

h2 {
    @include typography.h2;
}

h3 {
    @include typography.h3;
}

h4 {
    @include typography.h4;
}

h5 {
    @include typography.h5;
}

.text-p1 {
    font-size: 18px;
    line-height: 26px;
}

.text-p2 {
    font-size: var(--font-size-p2);
    line-height: var(--line-height-p2);
}

.text-aside {
    font-size: var(--font-size-aside);
    line-height: var(--line-height-aside);
}

// TODO: use actual h1, h2, h3, h4 elements, not spans!
.header {
    @include typography.h2;
    &.fullwidth {
        width: 100%;
        margin-bottom: 24px;
    }
}

.section-title-row {
    display: flex;
    align-items: center;
    margin-bottom: 32px;
    width: 100%;
    gap: 12px;

    h2, h3 {
        width: inherit;
    }
}

strong {
    font-weight: typography.$semi-bold;
}

.text-muted {
    color: colors.$secondary-light-grey;
}

a {
    color: colors.$white;
    text-decoration: none;
    &.disabled {
        pointer-events: none;
        cursor: default;
    }
}

@mixin text-link {
    text-decoration: underline;
    color: colors.$green;
    cursor: pointer;
}

p a, aside a, th a, td a {
    @include text-link;
}

a.link-quiet {
    color: colors.$grey;
    font-size: 14px;
    text-decoration: none;

    &:hover, &:focus {
        color: colors.$green;
        text-decoration: none;
    }
}

a.tos-privacy-link {
    color: colors.$white;
    text-decoration: underline;

    &:hover, &:focus {
        color: colors.$green;
    }
}

aside, .text-aside {
    @include typography.p3;
}

pre, code, .text-code {
    font-size: var(--font-size-code);
    line-height: var(--line-height-code);
}

code, .text-code {
    font-family: Monaco, monospace;
}

em {
    font-weight: typography.$semi-bold;
    color: colors.$secondary-extra-light-grey;
}

button {
    appearance: none;
    -webkit-appearance: none;
    background: none;
    border: 0;
    font-size: unset;
    font-family: unset;
    padding: 0;
    margin: 0;
    cursor: pointer;
    letter-spacing: var(--body-letter-spacing);

    &:disabled {
        cursor: not-allowed;
        color: colors.$secondary-mid-deep-grey;
    }
}

/* NB: these button styles are from typedb-web */
@mixin button {
    display: flex;
    border-width: 1px;
    border-style: solid;
    border-radius: var(--border-radius);
    justify-content: center;
    align-items: center;
    font-weight: var(--font-weight-semi-bold);
    font-size: inherit;
    font-family: inherit;
    cursor: pointer;
    transition-property: background-color, border, box-shadow, opacity;
    transition-duration: 100ms;
    transition-timing-function: ease;
    text-decoration: none !important; // overrides various styles that set an underline on anchors

    @media (min-width: media.$min-width-tablet) {
        height: 48px;
        width: 202px;
    }

    @media (max-width: media.$max-width-mobile) {
        height: 40px;
    }

    &.td-button-disabled {
        opacity: 50%;
        cursor: default;
    }

    &.td-button-size-s {
        height: 40px;
    }
}

@mixin button-primary {
    & {
        border-color: transparent;
        background: var(--color-green);
        color: var(--color-purple);
    }

    &:not(.td-button-disabled) {
        &:hover,
        &.container-hover {
            box-shadow: 0 3px 26px 0 rgba(colors.$green, 0.4);
        }

        &:active {
            background-color: color.mix(colors.$green, colors.$purple);
        }
    }
}

@mixin button-secondary {
    border-color: var(--color-green);
    background: transparent;
    color: var(--color-green);

    &:not(.td-button-disabled) {
        &:hover,
        &.container-hover {
            background-color: var(--color-green);
            color: var(--color-purple);
        }
    }
}

.button-primary {
    @include button;
    @include button-primary;
}

hr {
    border-top: shapes.$border;
    border-bottom: none;
}

form, .form {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.form-input-row-description {
    color: colors.$secondary-light-grey;
    font-size: 14px;
    text-align: start;
    margin: 11px 0;
}

input, select, textarea {
    &::placeholder {
        color: rgba(colors.$secondary-light-grey, 0.8);
        font-weight: typography.$regular;
    }
}

th {
    font-weight: typography.$semi-bold;
}

.flex-spacer {
    flex-grow: 1;
}

.flex-1 {
    flex: 1;
}

.flex-2 {
    flex: 2;
}

.flex-3 {
    flex: 3;
}

.invisible {
    visibility: hidden;
    pointer-events: none;
}

i {
    width: 16px;
    height: 16px;
    font-size: 16px;
    display: inline-flex;
    justify-content: center;

    &.ok {
        color: colors.$green;
    }

    &.info {
        color: colors.$secondary-blue;
    }

    &.warn {
        color: colors.$secondary-yellow;
    }

    &.error {
        color: colors.$red;
    }

    &.inactive {
        color: colors.$secondary-light-grey;
    }
}

button i + span, button span + i {
    margin-left: 8px;
}

.tp-green {
    color: colors.$green;
}

.card {
    @include mixins.card-appearance;
    @include mixins.card-padding;

    &.hoverable:hover:not(:disabled) {
        border-color: colors.$green;

        .link-tertiary {
            color: colors.$green;
            text-decoration: underline;
        }
    }
}

// copied over from typedb-docs-web
.admonitionblock {
    --important-color: #{colors.$secondary-yellow};
    --important-background: #{rgba(colors.$secondary-yellow, 0.12)};
    --note-color: #{colors.$secondary-blue};
    --note-background: #{rgba(colors.$secondary-blue, 0.12)};
    --tip-color: #{colors.$green};
    --tip-background: #{rgba(colors.$green, 0.12)};
    --warning-color: #{colors.$red};
    --warning-background: #{rgba(colors.$red, 0.12)};

    position: relative;
    margin: 1.5rem 0 0;
    padding: 16px;
    border-radius: var(--border-radius);
    color: var(--color-white);
    width: 100%;

    @media (max-width: media.$max-width-mobile) {
        padding: var(--card-padding);
    }

    > table,
    > table > tbody,
    > table > tbody > tr,
    > table > tbody > tr > td {
        display: block;
        padding: 0;
    }

    &::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 2px;
    }

    &.note {
        background: var(--note-background);

        .icon::after {
            content: "Note";
        }
    }

    &.note::before {
        background: var(--note-color);
    }

    &.important, &.attention {
        border-color: var(--important-color);
        background: var(--important-background);

        &::before {
            background: var(--important-color);
        }
    }

    &.important .icon::after {
        content: "Important";
    }

    &.attention .icon::after {
        content: "Attention";
    }

    &.tip {
        background: var(--tip-background);

        .icon::after {
            content: "Advanced";
        }
    }

    &.tip::before {
        background: var(--tip-color);
    }

    &.warning {
        background: var(--warning-background);

        .icon::after {
            content: "Warning";
        }
    }

    &.warning::before {
        background: var(--warning-color);
    }

    .icon {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        margin-bottom: 4px;

        &::after {
            font-weight: var(--font-weight-medium);
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: .5px;
        }
    }

    .content {
        margin-top: -0.5rem;
    }
}

.admonitionblock.attention i {
    color: colors.$secondary-yellow;
}

.action-bar {
    flex: 0 0 49px;
    display: flex;
    padding: 19px 0;
    position: sticky;
    top: 0;
    z-index: 10;

    > a,
    tp-button {
        display: flex;
        align-items: center;
        z-index: 20;
    }

    > tp-button + tp-button::before,
    > tp-button + a::before,
    > a + tp-button::before,
    > a + a::before,
    > div + tp-button::before,
    > div + a::before {
        content: "";
        width: 0;
        height: 24px;
        border-right: shapes.$border;
    }
}

tp-form .form-row, .form .form-row {
    display: flex;
    gap: 16px;

    > * {
        flex: 1;
    }
}

tp-form-actions, .tp-form-actions {
    display: flex;
    flex-flow: row wrap;
    justify-content: flex-end;
    width: 100%;
    column-gap: 14px;
    row-gap: 8px;
    margin-top: 20px;
}

.tp-password-input-suffix {
    display: flex;
    flex-direction: row;
    align-items: center;
}

.terms-privacy-additional-info {
    @include typography.p3;
    color: colors.$secondary-light-grey;
}

tp-properties-table + tp-properties-table {
    margin-top: 48px;
}

tp-org-area, tp-profile-scaffold {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

table td tp-user-avatar {
    margin-top: 4px;
}

tp-form-input.capitalized-field {
    text-transform: capitalize;
}

.modal-content-wrapper {
    @include typography.p3;
    color: colors.$grey;
    width: 100%;

    display: flex;
    gap: 8px;
    align-items: center;
}

.help-tooltip-button {
    width: 44px;
    height: 44px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: colors.$secondary-pink;
    cursor: pointer;
}

.info-block {
    display: flex;
    gap: 8px;
    align-items: center;
}

button.dangerous {
    color: colors.$red;
}

.tp-sidebar-team-selection-panel.mat-mdc-select-panel {
    background: rgba(colors.$light-purple, 0.3);
    backdrop-filter: blur(10px);
}

.tp-sidenav-container.collapsed ts-sidebar-link i.fa-arrow-up-right-from-square {
    transform: translate(-20px,-10px) scale(0.5);
}

tp-setup, tp-setup-marketplace, tp-setup-project,
tp-gcp-marketplace-integration, tp-aws-marketplace-integration, tp-azure-marketplace-integration {
    height: 100%;
    min-height: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.tp-liveness-indicator {
    display: flex;
    align-items: center;
    gap: 8px;

    tp-status-indicator {
        font-size: 8px;
        width: 8px;
        height: 8px;

        &.ok {
            animation: beacon 2s ease-in-out 0s infinite;

            @keyframes beacon {
                0% { opacity: 1 }
                10% { opacity: 1 }
                50% { opacity: 0 }
                90% { opacity: 1 }
                100% { opacity: 1 }
            }
        }
    }

    p {
        color: colors.$grey;

        &.ok {
            color: colors.$green;
        }

        &.loading {
            color: colors.$grey;
        }

        &.error {
            color: colors.$red;
        }

        &.inactive {
            color: colors.$secondary-light-grey;
        }
    }
}
